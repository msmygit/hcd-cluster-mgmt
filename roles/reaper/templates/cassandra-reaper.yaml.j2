---
# Cassandra Reaper Configuration
# Generated by Ansible

segmentCountPerNode: {{ reaper_segment_count_per_node }}
repairParallelism: PARALLEL
repairIntensity: {{ reaper_repair_intensity }}
scheduleDaysBetween: {{ reaper_schedule_days_between }}
repairRunThreadCount: {{ reaper_repair_run_threads }}
hangingRepairTimeoutMins: {{ reaper_hanging_repair_timeout_mins }}
storageType: {{ reaper_storage_type }}
enableCrossOrigin: true
incrementalRepair: false
blacklistTwcsTables: true

jmxConnectionTimeoutInSeconds: {{ reaper_jmx_connection_timeout }}

{% if reaper_storage_type == 'cassandra' %}
cassandra:
  clusterName: "{{ cluster_name }}"
  contactPoints: {{ reaper_cassandra_contact_points | to_json }}
  port: {{ reaper_cassandra_port }}
  keyspace: {{ reaper_cassandra_keyspace }}
  localDC: {{ reaper_cassandra_local_dc }}
{% if reaper_cassandra_auth_enabled %}
  authProvider:
    type: plainText
    username: {{ reaper_cassandra_username }}
    password: {{ reaper_cassandra_password }}
{% endif %}
{% endif %}

autoScheduling:
  enabled: {{ reaper_auto_scheduling_enabled | lower }}
  initialDelayPeriod: {{ reaper_auto_scheduling_initial_delay_period }}
  periodBetweenPolls: {{ reaper_auto_scheduling_period_between_polls }}
  timeBeforeFirstSchedule: {{ reaper_auto_scheduling_time_before_first_schedule }}
  scheduleSpreadPeriod: {{ reaper_auto_scheduling_schedule_spread_period }}
  excludedKeyspaces:
    - system
    - system_schema
    - system_auth
    - system_distributed
    - system_traces
    - reaper_db

logging:
  level: {{ reaper_log_level }}
  loggers:
    io.cassandrareaper: {{ reaper_log_level }}
    org.eclipse.jetty: WARN
  appenders:
    - type: console
      threshold: WARN
      timeZone: UTC
      target: stdout
    - type: file
      threshold: {{ reaper_log_level }}
      timeZone: UTC
      currentLogFilename: {{ reaper_log_dir }}/reaper.log
      archivedLogFilenamePattern: {{ reaper_log_dir }}/reaper-%d.log.gz
      archivedFileCount: 99

server:
  type: default
  applicationConnectors:
    - type: http
      port: {{ reaper_port }}
      bindHost: 0.0.0.0
  adminConnectors:
    - type: http
      port: {{ reaper_admin_port }}
      bindHost: 0.0.0.0

  requestLog:
    appenders:
      - type: file
        currentLogFilename: {{ reaper_log_dir }}/access.log
        archivedLogFilenamePattern: {{ reaper_log_dir }}/access-%d.log.gz
        archivedFileCount: 99

jmxPorts:
{% for port in reaper_jmx_ports %}
  {{ port }}: {{ port }}
{% endfor %}

jmxAuth:
  username:
  password:

cryptograph:
  type: symmetric
  systemPropertySecret: REAPER_ENCRYPTION_KEY